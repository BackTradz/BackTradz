/* ==========================================================================
   Stratify ‚Äî CSV Shop
   - CSS r√©organis√©e avec menu :root
   - üö´ aucun style sur <select> (g√©r√© par Select.css)
   - ‚úÖ 0 r√©gression : m√™mes classes conserv√©es
   ========================================================================== */

/* =========================
   üéõÔ∏è MENU :ROOT ‚Äî R√©glages rapides
   ========================= */
:root{
  /* Page / largeur */
  --shop-max: 1520px;                         /* largeur max du contenu (comme dashboard) */
  --shop-pad-x: clamp(16px, 4vw, 48px);       /* gutter lat√©ral */
  --shop-pad-t: 28px;                         /* padding top */
  --shop-pad-b: 56px;                         /* padding bottom */

  /* Grille */
  --grid-gap: 28px;
  --cols-lg: 4;
  --cols-md: 3;
  --cols-sm: 2;
  --cols-xs: 1;

  /* Cartes CSV */
  --card-radius: 16px;
  --card-pad-y: 18px;
  --card-pad-x: 20px;
  --card-min-h: 148px;
  --card-bg: #0f172a;
  --card-bd: rgba(255,255,255,.07);
  --card-shadow: 0 10px 24px rgba(0,0,0,.24);
  --card-shadow-hover: 0 14px 32px rgba(0,0,0,.28);

  /* Typo */
  --txt-main: #eaf2ff;
  --txt-soft: #cbd5e1;
  --txt-mute: #94a3b8;
  --title-accent: #38bdf8;

  /* Inputs / CTA align */
  --input-h: 44px;
  --input-radius: 10px;
}

/* =========================
   üß± Container & titres
   ========================= */
.csvshop-container{
  width: min(94vw, var(--shop-max));
  margin: 0 auto;
  padding: var(--shop-pad-t) var(--shop-pad-x) var(--shop-pad-b);
  color: var(--txt-main);
  box-sizing: border-box;
}
.csvshop-title{
  font-size: clamp(1.6rem, 2.4vw, 2rem);
  font-weight: 700;
  color: var(--title-accent);
  text-align: center;
  margin: 0 0 12px;
}
.csvshop-description{
  text-align: center;
  max-width: 760px;
  margin: 0 auto 22px;
  font-size: .95rem;
  line-height: 1.5;
  color: var(--txt-mute);
}

/* =========================
   üîé Filtres (recherche + CTA Extracteur)
   ========================= */
.csvshop-filters{
  display:flex; flex-wrap:wrap; justify-content:center; gap:12px;
  margin-bottom: 24px;
}

/* Inputs natifs uniquement (on NE touche plus les <select> custom) */
.csvshop-filters input{
  height: var(--input-h);
  background: #0f172a; color:#f8fafc;
  padding: 0 12px;
  border-radius: var(--input-radius);
  border: 1px solid #334155;
  outline: none; cursor: text;
  font-size: .95rem;
}

/* CTA dans la barre de filtres */
.csvshop-cta-filters.dbt-btn{
  height: var(--input-h);
  padding: 0 16px;
}

/* =========================
   üóÇÔ∏è Grille de cartes
   ========================= */
.csvshop-grid{
  display: grid;
  gap: var(--grid-gap);
  grid-template-columns: repeat(var(--cols-lg), minmax(0, 1fr));
  width: 100%;
}
@media (max-width: 1400px){ .csvshop-grid{ grid-template-columns: repeat(var(--cols-md), 1fr); } }
@media (max-width: 1050px){ .csvshop-grid{ grid-template-columns: repeat(var(--cols-sm), 1fr); } }
@media (max-width: 640px) { .csvshop-grid{ grid-template-columns: repeat(var(--cols-xs), 1fr); } }

/* =========================
   üì¶ Carte CSV
   ========================= */
.csvshop-card,
.csvshop-grid > .dashboard-card{
  background: var(--card-bg);
  border: 1px solid var(--card-bd);
  border-radius: var(--card-radius);
  padding: var(--card-pad-y) var(--card-pad-x);
  min-height: var(--card-min-h);
  box-shadow: var(--card-shadow);
  transition: transform .16s ease, box-shadow .18s ease, border-color .18s ease;
  width: 100%; box-sizing: border-box;
  overflow: hidden;
}
.csvshop-card:hover,
.csvshop-grid > .dashboard-card:hover{
  transform: translateY(-3px);
  border-color: rgba(56,189,248,.55);
  box-shadow: var(--card-shadow-hover);
}

/* Header / m√©ta */
.csvshop-card .dashboard-card__header .title-row{ display:flex; align-items:center; gap:10px; }
.csvshop-card .dashboard-card__header .title{ font-weight:700; font-size:18px; color:#e9f1ff; }
.csvshop-card .dashboard-card__header .badge-tf{
  display:inline-flex; align-items:center; padding:2px 10px; border-radius:999px;
  background: rgba(80,140,255,.18); color:#8db3ff; font-weight:600; font-size:13px;
}
.csvshop-card .csv-period{ margin-top:6px; font-size:14px; color:#b9c6da; text-align:left; }

.csvshop-card .csv-meta{ margin-top:14px; display:grid; grid-template-columns:1fr 1fr; gap:10px 18px; }
.csvshop-card .csv-meta .meta-line{ display:flex; gap:8px; }
.csvshop-card .csv-meta .meta-label{ color: var(--txt-mute); font-size:13px; }
.csvshop-card .csv-meta .meta-value{ color:#e6eefc; font-weight:600; font-size:14px; }
.csvshop-card .csv-source.library{ color:#a8c5ff; }
.csvshop-card .csv-source.live   { color:#fca5a5; }

/* Actions */
.csvshop-card .csv-actions{ margin-top:16px; display:flex; gap:12px; width:100%; }
.csvshop-card .csv-actions > *{ flex:1 1 0; min-width:0; }
.csvshop-card .csv-actions .dbt-btn{ height:48px; display:flex; align-items:center; justify-content:center; width:100%; }

/* =========================
   ‚úÖ Section ‚ÄúVotre extraction‚Äù
   ========================= */
.csvshop-private{ margin-top: 28px; }
.csvshop-header{ display:flex; align-items:center; gap:10px; margin-bottom:6px; color:var(--txt-main); }
.csvshop-cta-toggle.dbt-btn{ height:36px; padding:6px 12px; border-radius:10px; font-size:14px; }

/* =========================
   ‚õèÔ∏è Extracteur inline (form)
   ========================= */
.extractor{
  background: var(--card-bg);
  border: 1px solid var(--card-bd);
  border-radius: 12px;
  padding: 20px;
  margin-top: 8px;
}
.extractor__title{ margin:0; text-align:center; font-size:1.1rem; color:var(--txt-soft); font-weight:700; }
.extractor__subtitle{ text-align:center; margin:4px 0 16px; color:var(--txt-mute); font-size:.9rem; }

.extractor__presets{ display:flex; gap:8px; justify-content:center; flex-wrap:wrap; margin-bottom:12px; }
.chip{
  background: transparent; border:1px solid #334155; color:#e2e8f0;
  padding:6px 10px; border-radius:999px; font-size:.8rem; cursor:pointer;
}
.chip:hover{ border-color: var(--title-accent); }

.extractor__form{
  display:grid; gap:12px; grid-template-columns: 1.1fr .9fr 1fr 1fr auto; align-items:end;
}
@media (max-width: 860px){ .extractor__form{ grid-template-columns: 1fr 1fr; } }
@media (max-width: 520px){ .extractor__form{ grid-template-columns: 1fr; } }

.extractor__field label{ display:block; font-size:.8rem; color:var(--txt-mute); margin-bottom:6px; }
.extractor__field input{
  height: var(--input-h); background:#0f172a; color:#f8fafc;
  padding:0 12px; border-radius: var(--input-radius);
  border:1px solid #334155; outline:none; width:100%;
}

.segmented{ display:inline-flex; background:#0f172a; border:1px solid #334155; border-radius:10px; padding:3px; }
.segmented__btn{ background:transparent; color:#cbd5e1; border:0; padding:8px 12px; border-radius:8px; cursor:pointer; font-size:.9rem; }
.segmented__btn:hover{ color:#fff; }
.segmented__btn.is-active{ background: var(--title-accent); color:#0b1220; }

.extractor__actions{ display:flex; align-items:center; gap:10px; }
.extractor__error{ color:#ef4444; font-size:.85rem; }

/* =========================
   üì± Responsif fin
   ========================= */
@media (max-width: 480px){
  .csvshop-card{ padding: calc(var(--card-pad-y) - 4px) calc(var(--card-pad-x) - 4px); min-height: 132px; }
  .csvshop-title{ font-size: 1.4rem; }
}

/* Carte extraction priv√©e = pleine largeur */
.csvshop-private .csvshop-card,
.csvshop-private .dashboard-card {
  grid-column: 1 / -1;
  width: 100%;
  max-width: 100%;
}

/* Badge LIVE (priv√©) */
.csvshop-card .badge-live {
  display: inline-block;
  padding: 3px 8px;
  border-radius: 6px;
  font-size: 12px;
  font-weight: 600;
  line-height: 1.2;
  background: rgba(16, 185, 129, 0.15);
  color: #34d399;
  border: 1px solid rgba(16, 185, 129, 0.35);
  margin-left: auto;
}

/* Header align√© avec badge live */
.dashboard-card.csv-card .dashboard-card__header{
  display:flex; align-items:center; justify-content:space-between;
}

/* =========================
   ‚ÑπÔ∏è Bandeau d'infos CSV ‚Äî STRIP + POPOVER
   ========================= */
.csvshop-infobar.infobar--strip{
  background: var(--card-bg);
  border: 1px solid var(--card-bd);
  border-radius: 10px;
  padding: 10px 12px;
  margin: 8px 0 14px;
  display: flex; align-items: center; justify-content: space-between; gap: 12px;
  position: relative;
}
.infobar-strip-left{ display:flex; align-items:center; gap:10px; min-width:0; }
.infobar-icon{
  width: 22px; height: 22px; display:grid; place-items:center;
  border-radius: 6px; background: rgba(56,189,248,.14); color:#7dd3fc;
  border: 1px solid rgba(56,189,248,.25); font-size: 12px;
}
.infobar-strip-text{ display:flex; flex-direction:column; gap:2px; }
.infobar-strip-text strong{ color: var(--txt-main); font-size: .95rem; }
.infobar-strip-text .muted{ color: var(--txt-mute); font-size: .85rem; }

.infobar-strip-right{ display:flex; align-items:center; gap:10px; min-width:0; }
.infobar-chips{ display:flex; align-items:center; gap:6px; flex-wrap:wrap; }
.chip{ display:inline-flex; align-items:center; padding:6px 10px; border-radius:999px; font-size:.85rem; line-height:1; border:1px solid #334155; color:#e2e8f0; background:#0f172a; }
.chip--xs{ padding: 3px 8px; font-size: .78rem; }
.chip--required{ border-color: rgba(56,189,248,.45); color:#c7eeff; background: rgba(56,189,248,.12); }
.chip--optional{ border-color: rgba(148,163,184,.45); color:#cbd5e1; background: rgba(148,163,184,.10); }
.chip--divider{ border:0; background:transparent; color:#64748b; padding:0 4px; }
.infobar-details-btn.dbt-btn{ height: 32px; padding: 4px 10px; border-radius: 8px; font-size: .86rem; }

/* POPOVER flottant */
.infobar-popover{
  position: absolute;
  right: 12px; top: calc(100% + 10px);
  width: min(760px, calc(100vw - 2 * var(--shop-pad-x)));
  background: #0f172a;
  border: 1px solid var(--card-bd);
  border-radius: 12px;
  box-shadow: 0 16px 40px rgba(0,0,0,.42);
  padding: 12px;
  z-index: 80;
  animation: popIn .14s ease-out;
}
@keyframes popIn{
  from { opacity: 0; transform: translateY(-4px) scale(.98); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}
.popover-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom: 8px; }
.popover-head .title{ color:#e6eefc; font-weight:700; font-size:.95rem; }
.btn-ghost{ background: transparent; border:1px solid #334155; color:#e2e8f0; height:30px; padding:4px 8px; border-radius:8px; font-size:.84rem; }

.cols-table{ display:grid; gap:8px; grid-template-columns: 140px 120px 80px 1fr; }
.cols-table--compact .cols-head, .cols-table--compact .cols-cell{ font-size: .9rem; }
.cols-head{ font-weight:700; color:#e6eefc; }
.cols-cell{ color:#cbd5e1; }
.cols-desc{ grid-column: 4; }

.sample{ display:grid; gap:6px; margin-top: 10px; }
.sample--compact .sample-code{ font-size:12px; padding:8px 10px; border-radius:8px; }
.sample-caption{ color:#cbd5e1; font-size:.88rem; }
.sample-code{
  display:block; white-space:pre-wrap; word-break:break-all;
  background:#0f172a; border:1px solid #334155; color:#e6e9f2;
  padding:10px 12px; border-radius:10px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
}
.notes{ margin: 6px 0 0; padding-left: 18px; color:#94a3b8; font-size:.88rem; }

/* =========================
   ‚ú® Animations d‚Äôentr√©e ‚Äî CSV Shop uniquement
   ========================= */

/* Respecte l‚Äôaccessibilit√© */
@media (prefers-reduced-motion: reduce) {
  .csvshop-grid > .csvshop-card { animation: none !important; opacity: 1 !important; }
}

/* Keyframes ‚Äî m√™me logique que Dashboard pour la coh√©rence visuelle */
@keyframes csvCardIn {
  from { opacity: 0; transform: translateY(12px) scale(.98); }
  to   { opacity: 1; transform: translateY(0)    scale(1); }
}

/* Applique l‚Äôanimation √† chaque carte du shop (scop√©e par .csvshop-grid) */
.csvshop-grid > .csvshop-card {
  opacity: 0; /* √©vite le clignotement avant anim */
  animation: csvCardIn 520ms cubic-bezier(.22,.61,.36,1) both;
  will-change: opacity, transform;
}

/* Stagger l√©ger (12 premiers items) */
.csvshop-grid > .csvshop-card:nth-child(1)  { animation-delay: 40ms; }
.csvshop-grid > .csvshop-card:nth-child(2)  { animation-delay: 80ms; }
.csvshop-grid > .csvshop-card:nth-child(3)  { animation-delay: 120ms; }
.csvshop-grid > .csvshop-card:nth-child(4)  { animation-delay: 160ms; }
.csvshop-grid > .csvshop-card:nth-child(5)  { animation-delay: 200ms; }
.csvshop-grid > .csvshop-card:nth-child(6)  { animation-delay: 240ms; }
.csvshop-grid > .csvshop-card:nth-child(7)  { animation-delay: 280ms; }
.csvshop-grid > .csvshop-card:nth-child(8)  { animation-delay: 320ms; }
.csvshop-grid > .csvshop-card:nth-child(9)  { animation-delay: 360ms; }
.csvshop-grid > .csvshop-card:nth-child(10) { animation-delay: 400ms; }
.csvshop-grid > .csvshop-card:nth-child(11) { animation-delay: 440ms; }
.csvshop-grid > .csvshop-card:nth-child(12) { animation-delay: 480ms; }


/* Responsive: popover plein √©cran sur mobile */
@media (max-width: 640px){
  .infobar-popover{
    left: 12px; right: 12px;
    width: auto;
  }
  .cols-table{ grid-template-columns: 1fr 1fr; }
  .cols-head:nth-child(3), .cols-cell:nth-child(3n+3){ display:none; } /* cache "Oblig." */
}
